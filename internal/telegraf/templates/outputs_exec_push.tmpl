{{if and (hasPrefix .Metric "docker_container_") .ContainerName -}}
############################################
# Docker metric isolation (auto-generated)
############################################
[[processors.override]]
  namepass = ["{{.Metric}}"]
  tagpass = { container_name = ["{{.ContainerName}}"] }
  name_override = "{{.Metric}}_{{sanitizeMetric .ContainerName}}"
{{end -}}
############################################
# Push to Uptime Kuma
############################################
[[outputs.exec]]
  command = [
    "docker",
    "run",
    "--rm",
    "-i",
    "-v", "/etc/uptime-kuma-agent:/config:ro",
    "-v", "{{.HostLogDirectory}}:{{.InternalLogDirectory}}",
    "{{.DockerImage}}",
    "push-metric",
    "--monitor", "{{.MonitorName}}",
    "--group", "{{.Group}}",
    "--token", "{{.Token}}"
  ]

  {{if and (hasPrefix .Metric "docker_container_") .ContainerName -}}
  namepass = ["{{.Metric}}_{{sanitizeMetric .ContainerName}}"]
  {{else -}}
  namepass = ["{{.Metric}}"]
  {{end -}}
  fieldinclude = ["{{.Field}}"]

{{if .Filesystem -}}
  [outputs.exec.tagpass]
    path = ["{{.Filesystem}}"]
{{end -}}